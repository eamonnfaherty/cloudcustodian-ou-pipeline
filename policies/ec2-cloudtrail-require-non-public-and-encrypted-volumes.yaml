policies:
- name: ec2-cloudtrail-require-non-public-and-encrypted-volumes
  resource: ec2
  description: |
    Provision a lambda and cloud watch event target
    that looks at all new instances and terminates those with
    unencrypted volumes.
  mode:
    type: cloudtrail
    events:
    - RunInstances
  filters:
  - type: aws.ebs
    key: Encrypted
    value: false
  actions:
  - stop